repos:
  - repo: https://github.com/pycqa/isort
    rev: 7.0.0
    hooks:
      - id: isort
        files: ^v2/

  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.15.0
    hooks:
      - id: ruff-format
        files: ^v2/
      - id: ruff
        files: ^v2/

  - repo: local
    hooks:
      - id: ty
        name: ty check
        entry: v2/.env/bin/ty check v2/
        language: system
        pass_filenames: false
        files: ^v2/.*\.py$

      - id: pytest-engine
        name: pytest engine
        entry: bash -c 'cd v2 && .env/bin/python -m pytest engine/ --no-header -q; ret=$?; [ $ret -eq 5 ] && exit 0 || exit $ret'
        language: system
        pass_filenames: false
        files: (^v2/engine/.*\.py$|requirements.*\.txt$)

      - id: pytest-frontend
        name: pytest frontend
        entry: bash -c 'cd v2 && .env/bin/python -m pytest frontend/ --no-header -q; ret=$?; [ $ret -eq 5 ] && exit 0 || exit $ret'
        language: system
        pass_filenames: false
        files: (^v2/(engine|frontend)/.*\.py$|requirements.*\.txt$)

      - id: cargo-fmt
        name: cargo fmt
        entry: bash -c 'cd v2/engine_rs && cargo fmt --check'
        language: system
        pass_filenames: false
        files: ^v2/engine_rs/.*\.rs$

      - id: cargo-clippy
        name: cargo clippy
        entry: bash -c 'cd v2/engine_rs && cargo clippy --quiet -- -D warnings'
        language: system
        pass_filenames: false
        files: ^v2/engine_rs/

      - id: cargo-test
        name: cargo test
        entry: bash -c 'cd v2/engine_rs && cargo test --quiet'
        language: system
        pass_filenames: false
        files: ^v2/engine_rs/.*\.rs$
